python profile.py --no_grad -j 1 -f
Type Time (%) Time (ms)  Calls       Avg       Min       Max                                               Name
GPU activities:    35.08    5.8594     30  195.31us  159.49us  240.39us  void spatialDepthwiseConvolutionUpdateOutput<f...
GPU activities:    17.23    2.8786     30  95.951us  93.985us  98.561us  void kernelPointwiseApply2<TensorTakeOp<float,...
GPU activities:    11.28    1.8849     50  37.698us  1.9200us  98.177us  void kernelPointwiseApply3<TensorAddOp<long>, ...
GPU activities:     8.88    1.4837     60  24.727us  20.256us  30.273us  void kernelPointwiseApply2<CopyOp<float, float...
GPU activities:     5.75   0.96065     30  32.021us  28.512us  35.360us  void kernelPointwiseApply3<TensorAddOp<float>,...
GPU activities:     5.34   0.89268     30  29.755us  28.640us  31.040us  void kernelPointwiseApply3<TensorSubOp<float>,...
GPU activities:     4.24   0.70762     15  47.174us  43.744us  49.152us  void kernelPointwiseApply2<TensorDivConstantOp...
GPU activities:     4.18   0.69837     30  23.279us  22.240us  27.712us  void kernelPointwiseApply2<CopyOp<float, float...
GPU activities:     4.03   0.67373     37  18.209us     864ns  636.90us                                 [CUDA memcpy HtoD]
GPU activities:     0.77   0.12871    120  1.0720us     960ns  1.9840us                                 [CUDA memcpy DtoH]
GPU activities:     0.71   0.11917     30  3.9720us  3.8400us  4.1280us  void kernelReduceAll<long, unsigned int, long,...
GPU activities:     0.67   0.11178     30  3.7250us  3.6480us  3.8720us  void kernelReduceAll<long, unsigned int, long,...
GPU activities:     0.47  0.078816     60  1.3130us     928ns  7.8400us  void kernelPointwiseApply2<TensorMulConstantOp...
GPU activities:     0.37  0.062561     60  1.0420us     768ns  1.7280us  void kernelPointwiseApply1<TensorFillOp<long>,...
GPU activities:     0.37  0.061728     50  1.2340us     800ns  1.7920us  void thrust::cuda_cub::core::_kernel_agent<thr...
GPU activities:     0.28   0.04672     30  1.5570us  1.5040us  1.7280us  void kernelPointwiseApply2<CopyOp<float, float...
GPU activities:     0.27  0.045505     30  1.5160us  1.4720us  1.6330us  void kernelPointwiseApply2<TensorRemainderOp<l...
GPU activities:     0.06  0.010241     10  1.0240us     864ns  1.5680us                                      [CUDA memset]
         Total:    99.98   16.7049    732                                                                                 
Total (no mem):    95.18   15.9024    575                                                                                 
     API calls:    97.46   5590.86     10  559.09ms  26.226us  5.58199s                                         cudaMalloc
     API calls:     2.04    117.21      1  117.21ms  117.21ms  117.21ms                              cudaDeviceSynchronize
     API calls:     0.13    7.5209    565  13.311us  7.7030us  142.30us                                         cudaLaunch
     API calls:     0.08    4.3643    185  23.590us     204ns  1.0265ms                               cuDeviceGetAttribute
     API calls:     0.08    4.3055      2  2.1527ms  2.0874ms  2.2180ms                            cudaGetDeviceProperties
     API calls:     0.06    3.5372    157  22.529us  6.9180us  721.33us                                    cudaMemcpyAsync
     API calls:     0.05    2.8006   6778     413ns     313ns  15.137us                                      cudaGetDevice
     API calls:     0.04     2.563    157  16.324us  2.0990us  179.64us                              cudaStreamSynchronize
     API calls:     0.02    1.1446   2327     491ns     342ns  14.791us                                      cudaSetDevice
     API calls:     0.01   0.54522   2810     194ns     133ns  14.352us                                  cudaSetupArgument
     API calls:     0.01   0.44027      2  220.13us  219.75us  220.52us                                   cuDeviceTotalMem
     API calls:     0.01   0.38562      2  192.81us  191.90us  193.72us                                    cuDeviceGetName
     API calls:        0   0.24357     50  4.8710us  3.5510us  19.200us                              cudaFuncGetAttributes
     API calls:        0   0.14909    605     246ns     140ns  2.1410us                                   cudaGetLastError
     API calls:        0   0.14696    565     260ns     177ns     968ns                                  cudaConfigureCall
     API calls:        0  0.083828     10  8.3820us  5.0370us  13.126us                                    cudaMemsetAsync
     API calls:        0  0.032268     50     645ns     471ns  1.0870us                             cudaDeviceGetAttribute
     API calls:        0  0.022486    100     224ns     127ns     372ns                                cudaPeekAtLastError
     API calls:        0  0.004883     13     375ns     164ns  1.1990us                                 cudaGetDeviceCount
     API calls:        0  0.002998      4     749ns     219ns  2.0670us                                   cuDeviceGetCount
     API calls:        0  0.001406      3     468ns     220ns     888ns                                        cuDeviceGet
     API calls:        0  0.001147      1  1.1470us  1.1470us  1.1470us                                             cuInit
     API calls:        0    0.0006      1     600ns     600ns     600ns                                 cuDriverGetVersion
         Total:    99.99   5736.37  14398