python profile.py --no_grad -j 2 -f
Type Time (%) Time (ms)  Calls       Avg       Min       Max                                               Name
GPU activities:    30.18    8.6393     60  143.99us  68.001us  241.03us  void spatialDepthwiseConvolutionUpdateOutput<f...
GPU activities:    18.52    5.3033     90  58.925us  27.200us  98.721us  void kernelPointwiseApply2<TensorTakeOp<float,...
GPU activities:    14.23    4.0728    150  27.152us  1.5040us  98.017us  void kernelPointwiseApply3<TensorAddOp<long>, ...
GPU activities:     5.78    1.6561    120  13.800us  2.2400us  30.656us  void kernelPointwiseApply2<CopyOp<float, float...
GPU activities:     4.25    1.2173     60  20.288us  2.9120us  55.136us  void CatArrayBatchedCopy<float, unsigned int, ...
GPU activities:     3.95    1.1301     60  18.835us  2.7520us  35.521us  void kernelPointwiseApply3<TensorAddOp<float>,...
GPU activities:     3.68    1.0535     60  17.558us  3.8400us  31.328us  void kernelPointwiseApply3<TensorSubOp<float>,...
GPU activities:     3.38   0.96718    157  6.1600us     864ns  797.96us                                 [CUDA memcpy HtoD]
GPU activities:      3.1   0.88794     60  14.799us  5.9200us  27.520us  void kernelPointwiseApply2<CopyOp<float, float...
GPU activities:     3.07   0.87937     30  29.312us  11.137us  48.896us  void kernelPointwiseApply2<TensorDivConstantOp...
GPU activities:      2.2   0.63025    110  5.7290us  1.0560us  29.249us  void kernelPointwiseApply2<CopyOp<float, float...
GPU activities:     1.54   0.43988    360  1.2210us     992ns  2.4320us                                 [CUDA memcpy DtoH]
GPU activities:     1.24   0.35578     90  3.9530us  3.7120us  4.3520us  void kernelReduceAll<long, unsigned int, long,...
GPU activities:     1.15    0.3304     90  3.6710us  3.5840us  3.8720us  void kernelReduceAll<long, unsigned int, long,...
GPU activities:     0.83   0.23789    180  1.3210us     928ns  2.2080us  void kernelPointwiseApply2<TensorMulConstantOp...
GPU activities:     0.79   0.22653     40  5.6630us  5.0240us  6.3680us  void kernelPointwiseApply2<CopyOp<float, float...
GPU activities:     0.76   0.21664    150  1.4440us     800ns  13.633us  void thrust::cuda_cub::core::_kernel_agent<thr...
GPU activities:     0.73    0.2081    180  1.1560us     768ns  13.409us  void kernelPointwiseApply1<TensorFillOp<long>,...
GPU activities:     0.57   0.16346     90  1.8160us  1.6320us  13.472us  void kernelPointwiseApply2<TensorRemainderOp<l...
GPU activities:     0.05  0.013696     10  1.3690us     896ns  2.3040us                                      [CUDA memset]
         Total:      100   28.6295   2147                                                                                 
Total (no mem):    95.08   27.2225   1630                                                                                 
     API calls:    96.58   5254.85     15  350.32ms  10.277us  5.24760s                                         cudaMalloc
     API calls:     2.15    116.84      1  116.84ms  116.84ms  116.84ms                              cudaDeviceSynchronize
     API calls:      0.4    21.923   1620  13.532us  7.9280us  681.91us                                         cudaLaunch
     API calls:     0.21    11.335    185  61.270us     162ns  4.3761ms                               cuDeviceGetAttribute
     API calls:     0.17    9.5086    517  18.391us  7.6570us  862.46us                                    cudaMemcpyAsync
     API calls:     0.15    8.2189  19413     423ns     316ns  26.355us                                      cudaGetDevice
     API calls:     0.08    4.3993      2  2.1996ms  2.1928ms  2.2064ms                            cudaGetDeviceProperties
     API calls:     0.08    4.1797    457  9.1450us  2.0060us  186.58us                              cudaStreamSynchronize
     API calls:     0.07    3.5929   6572     546ns     427ns  16.063us                                      cudaSetDevice
     API calls:     0.03    1.6571      1  1.6571ms  1.6571ms  1.6571ms                                      cudaHostAlloc
     API calls:     0.03    1.5525   7650     202ns     132ns  15.971us                                  cudaSetupArgument
     API calls:     0.01   0.61505    150  4.1000us  3.4740us  18.399us                              cudaFuncGetAttributes
     API calls:     0.01   0.49112   1840     266ns     135ns  15.747us                                   cudaGetLastError
     API calls:     0.01   0.48733   1620     300ns     202ns  15.327us                                  cudaConfigureCall
     API calls:     0.01    0.3816      2  190.80us  188.21us  193.39us                                   cuDeviceTotalMem
     API calls:     0.01   0.36626      2  183.13us  180.82us  185.44us                                    cuDeviceGetName
     API calls:        0   0.18346     59  3.1090us  2.3790us  18.293us                                     cudaEventQuery
     API calls:        0    0.1024     60  1.7060us  1.3960us  2.6850us                           cudaEventCreateWithFlags
     API calls:        0  0.096937    150     646ns     480ns  1.0130us                             cudaDeviceGetAttribute
     API calls:        0  0.092184     59  1.5620us  1.2420us  2.2760us                                   cudaEventDestroy
     API calls:        0  0.089645     60  1.4940us  1.1580us  1.9830us                                    cudaEventRecord
     API calls:        0  0.086121     10  8.6120us  4.8560us  14.409us                                    cudaMemsetAsync
     API calls:        0  0.082219    300     274ns     140ns  13.936us                                cudaPeekAtLastError
     API calls:        0  0.013126     13  1.0090us     129ns  10.329us                                 cudaGetDeviceCount
     API calls:        0  0.002334      4     583ns     145ns  1.5760us                                   cuDeviceGetCount
     API calls:        0  0.001256      1  1.2560us  1.2560us  1.2560us                                             cuInit
     API calls:        0  0.001233      3     411ns     214ns     684ns                                        cuDeviceGet
     API calls:        0  0.000766      1     766ns     766ns     766ns                                 cuDriverGetVersion
         Total:      100   5441.15  40767