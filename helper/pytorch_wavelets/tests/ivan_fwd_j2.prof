python profile.py --no_grad -j 2 -f --fb
Type Time (%) Time (ms)  Calls       Avg       Min       Max                                               Name
GPU activities:    44.57    17.413     80  217.66us  92.448us  344.19us  void spatialDepthwiseConvolutionUpdateOutput<f...
GPU activities:    14.43    5.6381     80  70.475us  33.152us  107.65us  void kernelPointwiseApply2<TensorTakeOp<float,...
GPU activities:     13.6    5.3127    120  44.272us  1.6000us  131.71us  void kernelPointwiseApply3<TensorAddOp<long>, ...
GPU activities:     6.31    2.4655     20  123.27us  53.504us  193.73us  void kernelPointwiseApply2<CopyOp<float, float...
GPU activities:     3.48    1.3613     80  17.016us  4.0320us  38.272us  void kernelPointwiseApply2<CopyOp<float, float...
GPU activities:     2.79    1.0897    193  5.6460us     864ns  841.35us                                 [CUDA memcpy HtoD]
GPU activities:     2.73    1.0684    120  8.9030us  4.2560us  13.760us  void kernelPointwiseApply2<CopyOp<float, float...
GPU activities:     2.42   0.94414    120  7.8670us  2.5280us  13.152us  void kernelPointwiseApply2<TensorDivConstantOp...
GPU activities:     2.12   0.82999     60  13.833us  6.5920us  20.640us  void kernelPointwiseApply3<TensorAddOp<float>,...
GPU activities:     1.89   0.73953     60  12.325us  4.0640us  20.640us  void kernelPointwiseApply3<TensorSubOp<float>,...
GPU activities:     1.53   0.59648     80  7.4560us  5.2800us  9.5680us  void CatArrayBatchedCopy<float, unsigned int, ...
GPU activities:     0.87   0.34036    320  1.0630us     960ns  1.3120us                                 [CUDA memcpy DtoH]
GPU activities:     0.81    0.3168     80  3.9600us  3.8400us  4.1600us  void kernelReduceAll<long, unsigned int, long,...
GPU activities:     0.81   0.31616     80  3.9520us  3.8400us  4.0640us  void kernelReduceAll<long, unsigned int, long,...
GPU activities:     0.52   0.20445    160  1.2770us     960ns  1.5360us  void kernelPointwiseApply2<TensorMulConstantOp...
GPU activities:      0.4   0.15568    160     973ns     768ns  11.168us  void kernelPointwiseApply1<TensorFillOp<long>,...
GPU activities:     0.38    0.1473    120  1.2270us     800ns  1.8880us  void thrust::cuda_cub::core::_kernel_agent<thr...
GPU activities:     0.34   0.13242     80  1.6550us  1.5680us  1.8240us  void kernelPointwiseApply2<TensorRemainderOp<l...
         Total:      100    39.072   2013                                                                                 
Total (no mem):    96.34    37.642   1500                                                                                 
     API calls:    96.88   5635.25     24  234.80ms  9.6720us  5.62489s                                         cudaMalloc
     API calls:     2.02    117.76      1  117.76ms  117.76ms  117.76ms                              cudaDeviceSynchronize
     API calls:     0.34    19.969   1500  13.312us  6.7680us  136.42us                                         cudaLaunch
     API calls:     0.16    9.5245    513  18.566us  7.0690us  950.29us                                    cudaMemcpyAsync
     API calls:     0.14    8.1738  16989     481ns     295ns  643.67us                                      cudaGetDevice
     API calls:     0.12    7.0045    433  16.176us  1.9130us  246.05us                              cudaStreamSynchronize
     API calls:     0.08    4.4317    185  23.955us     160ns  1.0459ms                               cuDeviceGetAttribute
     API calls:     0.07    4.3474      2  2.1737ms  2.1516ms  2.1958ms                            cudaGetDeviceProperties
     API calls:     0.05    2.8844   5712     504ns     327ns  103.99us                                      cudaSetDevice
     API calls:     0.03    1.7106      1  1.7106ms  1.7106ms  1.7106ms                                      cudaHostAlloc
     API calls:     0.03    1.5628   7520     207ns     126ns  18.060us                                  cudaSetupArgument
     API calls:     0.02     1.324      2  661.99us  178.24us  1.1457ms                                    cuDeviceGetName
     API calls:     0.01   0.57574    120  4.7970us  3.1740us  21.833us                              cudaFuncGetAttributes
     API calls:     0.01   0.43702   1500     291ns     172ns  15.520us                                  cudaConfigureCall
     API calls:     0.01   0.39415   1740     226ns     128ns     594ns                                   cudaGetLastError
     API calls:     0.01   0.38259      2  191.30us  176.18us  206.41us                                   cuDeviceTotalMem
     API calls:     0.01   0.31462     79  3.9820us  3.0390us  5.7830us                                     cudaEventQuery
     API calls:        0   0.16312     80  2.0390us  1.5350us  12.266us                           cudaEventCreateWithFlags
     API calls:        0   0.16173     80  2.0210us  1.5230us  11.833us                                    cudaEventRecord
     API calls:        0   0.15536     79  1.9660us  1.5100us  2.8270us                                   cudaEventDestroy
     API calls:        0  0.084878    120     707ns     445ns  1.4880us                             cudaDeviceGetAttribute
     API calls:        0  0.053606    240     223ns     122ns     495ns                                cudaPeekAtLastError
     API calls:        0  0.004527     13     348ns     139ns  1.0460us                                 cudaGetDeviceCount
     API calls:        0  0.002297      4     574ns     179ns  1.4890us                                   cuDeviceGetCount
     API calls:        0  0.001208      3     402ns     224ns     726ns                                        cuDeviceGet
     API calls:        0   0.00105      1  1.0500us  1.0500us  1.0500us                                             cuInit
     API calls:        0  0.000707      1     707ns     707ns     707ns                                 cuDriverGetVersion
         Total:    99.99   5816.68  36944