python profile.py --no_grad -j 1 -f --fb
Type Time (%) Time (ms)  Calls       Avg       Min       Max                                               Name
GPU activities:    46.62    13.553     40  338.84us  331.88us  344.20us  void spatialDepthwiseConvolutionUpdateOutput<f...
GPU activities:    14.57    4.2351     40  105.88us  104.19us  107.68us  void kernelPointwiseApply2<TensorTakeOp<float,...
GPU activities:    12.01    3.4929     60  58.214us  2.1760us  117.22us  void kernelPointwiseApply3<TensorAddOp<long>, ...
GPU activities:     6.51    1.8931     10  189.31us  186.66us  192.83us  void kernelPointwiseApply2<CopyOp<float, float...
GPU activities:      3.5    1.0178     40  25.444us  13.025us  38.080us  void kernelPointwiseApply2<CopyOp<float, float...
GPU activities:     3.26   0.94881     97  9.7810us     896ns  802.12us                                 [CUDA memcpy HtoD]
GPU activities:      2.7   0.78541     60  13.090us  12.704us  14.048us  void kernelPointwiseApply2<CopyOp<float, float...
GPU activities:     2.64   0.76692     60  12.782us  12.320us  13.216us  void kernelPointwiseApply2<TensorDivConstantOp...
GPU activities:     2.06   0.59984     30  19.994us  19.424us  20.640us  void kernelPointwiseApply3<TensorSubOp<float>,...
GPU activities:     2.06   0.59927     30  19.975us  19.393us  20.992us  void kernelPointwiseApply3<TensorAddOp<float>,...
GPU activities:     1.07   0.30967     40  7.7410us  5.7280us  9.7600us  void CatArrayBatchedCopy<float, unsigned int, ...
GPU activities:      0.7   0.20435    160  1.2770us     992ns  11.904us                                 [CUDA memcpy DtoH]
GPU activities:     0.57   0.16701     40  4.1750us  3.8720us  12.768us  void kernelReduceAll<long, unsigned int, long,...
GPU activities:     0.57   0.16519     40  4.1290us  3.8400us  11.616us  void kernelReduceAll<long, unsigned int, long,...
GPU activities:      0.4   0.11549     80  1.4430us     960ns  13.088us  void kernelPointwiseApply2<TensorMulConstantOp...
GPU activities:     0.27  0.078785     80     984ns     768ns  1.9520us  void kernelPointwiseApply1<TensorFillOp<long>,...
GPU activities:     0.26  0.075521     60  1.2580us     800ns  1.9200us  void thrust::cuda_cub::core::_kernel_agent<thr...
GPU activities:     0.23    0.0656     40  1.6400us  1.6000us  1.7920us  void kernelPointwiseApply2<TensorRemainderOp<l...
         Total:      100   29.0738   1007                                                                                 
Total (no mem):    96.04   27.9206    750                                                                                 
     API calls:    96.95   5285.81     11  480.53ms  19.267us  5.28032s                                         cudaMalloc
     API calls:     2.17    118.32      1  118.32ms  118.32ms  118.32ms                              cudaDeviceSynchronize
     API calls:     0.19    10.124    750  13.498us  6.8410us  124.49us                                         cudaLaunch
     API calls:     0.18     9.573      2  4.7865ms  3.3674ms  6.2057ms                            cudaGetDeviceProperties
     API calls:     0.13    7.3245    185  39.592us     142ns  3.6720ms                               cuDeviceGetAttribute
     API calls:     0.11    6.1651    217  28.410us  1.8940us  219.64us                              cudaStreamSynchronize
     API calls:      0.1    5.3707    257  20.897us  6.7230us  888.70us                                    cudaMemcpyAsync
     API calls:     0.07    3.6246   8498     426ns     316ns  28.191us                                      cudaGetDevice
     API calls:     0.03    1.6246      1  1.6246ms  1.6246ms  1.6246ms                                      cudaHostAlloc
     API calls:     0.03    1.4306   2857     500ns     343ns  16.804us                                      cudaSetDevice
     API calls:     0.01   0.73519   3760     195ns     134ns  10.907us                                  cudaSetupArgument
     API calls:     0.01   0.39263      2  196.31us  182.77us  209.86us                                    cuDeviceGetName
     API calls:     0.01   0.37031      2  185.15us  179.43us  190.88us                                   cuDeviceTotalMem
     API calls:        0   0.24155     60  4.0250us  3.4220us  9.7160us                              cudaFuncGetAttributes
     API calls:        0   0.21335    750     284ns     185ns     605ns                                  cudaConfigureCall
     API calls:        0   0.20298    870     233ns     138ns     453ns                                   cudaGetLastError
     API calls:        0    0.1448     39  3.7120us  3.3040us  4.5100us                                     cudaEventQuery
     API calls:        0  0.092183     40  2.3040us  1.7370us  16.214us                           cudaEventCreateWithFlags
     API calls:        0  0.086611     40  2.1650us  1.5920us  16.354us                                    cudaEventRecord
     API calls:        0   0.07337     39  1.8810us  1.6470us  2.2760us                                   cudaEventDestroy
     API calls:        0   0.04329     60     721ns     508ns  1.1800us                             cudaDeviceGetAttribute
     API calls:        0  0.024757    120     206ns     132ns     327ns                                cudaPeekAtLastError
     API calls:        0  0.004504     13     346ns     126ns  1.1140us                                 cudaGetDeviceCount
     API calls:        0  0.002465      4     616ns     161ns  1.7650us                                   cuDeviceGetCount
     API calls:        0  0.001237      1  1.2370us  1.2370us  1.2370us                                             cuInit
     API calls:        0   0.00098      3     326ns     188ns     524ns                                        cuDeviceGet
     API calls:        0  0.000793      1     793ns     793ns     793ns                                 cuDriverGetVersion
         Total:    99.99      5452  18583